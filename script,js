// âœ… 1. Mensaje al hacer clic en cualquier botÃ³n
document.querySelectorAll("button, .btn").forEach(btn => {
  btn.addEventListener("click", () => {
    alert("Pronto se habilitarÃ¡ el pago automÃ¡tico. ContÃ¡ctanos por WhatsApp para comprar.");
  });
});

// âœ… 2. Animaciones al hacer scroll (fade in a las tarjetas)
document.addEventListener("DOMContentLoaded", () => {
  const elements = document.querySelectorAll('.product-card');
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        observer.unobserve(entry.target);
      }
    });
  });
  elements.forEach(el => observer.observe(el));
});

// âœ… 3. Modo Oscuro
const toggle = document.getElementById('dark-toggle');
if (toggle) {
  toggle.addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
    toggle.innerText = document.body.classList.contains('dark-mode') ? 'â˜€ï¸' : 'ðŸŒ™';
  });
}

// âœ… 4. Contador animado
function animateCounter(id, end, duration) {
  let start = 0;
  const stepTime = Math.abs(Math.floor(duration / end));
  const obj = document.getElementById(id);
  if (!obj) return;
  const timer = setInterval(() => {
    start++;
    obj.innerText = start.toLocaleString();
    if (start >= end) clearInterval(timer);
  }, stepTime);
}
animateCounter("counter", 1200, 1000);

// âœ… 5. Copiar nÃºmero de WhatsApp
function copyText(text) {
  navigator.clipboard.writeText(text).then(() => {
    alert("NÃºmero copiado al portapapeles âœ…");
  }).catch(err => {
    console.error("Error al copiar:", err);
  });
}

// âœ… 6. CHAT DE SOPORTE INTERACTIVO
document.addEventListener('DOMContentLoaded', () => {
  const supportBtn = document.getElementById('support-btn');
  const chat = document.getElementById('support-chat');
  const closeChatBtn = document.getElementById('close-chat');
  const chatMessages = document.getElementById('chat-messages');
  const chatOptions = document.getElementById('chat-options');

  const conversation = {
    start: {
      message: 'Hola ðŸ‘‹, Â¿en quÃ© podemos ayudarte hoy?',
      options: [
        { text: 'Problemas con compra', next: 'compra' },
        { text: 'Dudas sobre producto', next: 'producto' },
        { text: 'Contacto directo', next: 'contacto' },
      ]
    },
    compra: {
      message: 'Â¿QuÃ© problema tienes con la compra?',
      options: [
        { text: 'No recibÃ­ mi pedido', next: 'pedido' },
        { text: 'Quiero cancelar una orden', next: 'cancelar' },
        { text: 'Volver al inicio', next: 'start' },
      ]
    },
    producto: {
      message: 'Â¿Sobre quÃ© producto tienes dudas?',
      options: [
        { text: 'Discord Nitro', next: 'nitro' },
        { text: 'Server Boost', next: 'boost' },
        { text: 'Volver al inicio', next: 'start' },
      ]
    },
    contacto: {
      message: 'Puedes contactarnos vÃ­a WhatsApp haciendo clic aquÃ­:',
      options: [
        {
          text: 'Abrir WhatsApp', next: 'end', action: () => {
            window.open('https://wa.me/1234567890', '_blank');
          }
        },
        { text: 'Volver al inicio', next: 'start' },
      ]
    },
    pedido: {
      message: 'Por favor espera 24 horas. Si no recibes tu pedido despuÃ©s de ese tiempo, contÃ¡ctanos.',
      options: [
        { text: 'Volver al inicio', next: 'start' }
      ]
    },
    cancelar: {
      message: 'Para cancelar una orden, envÃ­anos tu nÃºmero de pedido por WhatsApp.',
      options: [
        {
          text: 'Abrir WhatsApp', next: 'end', action: () => {
            window.open('https://wa.me/1234567890', '_blank');
          }
        },
        { text: 'Volver al inicio', next: 'start' },
      ]
    },
    nitro: {
      message: 'El Discord Nitro ofrece emojis personalizados, mejor calidad y mÃ¡s. Â¿Quieres comprar?',
      options: [
        { text: 'SÃ­, comprar', next: 'contacto' },
        { text: 'Volver al inicio', next: 'start' },
      ]
    },
    boost: {
      message: 'Server Boost mejora tu servidor. Â¿Quieres precios?',
      options: [
        { text: 'SÃ­, precios', next: 'preciosBoost' },
        { text: 'Volver al inicio', next: 'start' },
      ]
    },
    preciosBoost: {
      message: 'Server Boosts desde $3.99 al mes. Â¿Quieres comprar?',
      options: [
        { text: 'SÃ­, comprar', next: 'contacto' },
        { text: 'Volver al inicio', next: 'start' },
      ]
    },
    end: {
      message: 'Gracias por contactarnos. Â¡Que tengas un buen dÃ­a! ðŸ˜Š',
      options: []
    }
  };

  function addBotMessage(text) {
    const msg = document.createElement('div');
    msg.classList.add('chat-message', 'bot-message');
    msg.textContent = text;
    chatMessages.appendChild(msg);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  function addUserMessage(text) {
    const msg = document.createElement('div');
    msg.classList.add('chat-message', 'user-message');
    msg.textContent = text;
    chatMessages.appendChild(msg);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  function addOptionButton(text, onClick) {
    const btn = document.createElement('button');
    btn.textContent = text;
    btn.addEventListener('click', onClick);
    chatOptions.appendChild(btn);
  }

  function clearOptions() {
    chatOptions.innerHTML = '';
  }

  function handleStep(stepKey) {
    clearOptions();
    if (!conversation[stepKey]) return;
    const step = conversation[stepKey];
    addBotMessage(step.message);

    if (step.options.length === 0) {
      addOptionButton('Cerrar chat', () => {
        chat.classList.add('hidden');
        chatMessages.innerHTML = '';
        clearOptions();
      });
      return;
    }

    step.options.forEach(opt => {
      addOptionButton(opt.text, () => {
        addUserMessage(opt.text);
        if (opt.action) opt.action();
        chatMessages.scrollTop = chatMessages.scrollHeight;
        chatOptions.innerHTML = '';
        setTimeout(() => handleStep(opt.next), 700);
      });
    });
  }

  function startChat() {
    chatMessages.innerHTML = '';
    clearOptions();
    handleStep('start');
  }

  supportBtn.addEventListener('click', () => {
    chat.classList.toggle('hidden');
    if (!chat.classList.contains('hidden')) startChat();
  });

  closeChatBtn.addEventListener('click', () => {
    chat.classList.add('hidden');
  });
});

// âœ… 7. SecciÃ³n "Ropa y armas personalizadas"
const contenidoPrincipal = document.getElementById('contenido-principal');
document.getElementById('btn-ropa-armas').addEventListener('click', () => {
  contenidoPrincipal.innerHTML = `
    <h2>Ropa y armas personalizadas</h2>
    <p>AquÃ­ puedes ver nuestras opciones de ropa y armas personalizadas.</p>
    <div class="productos">
      <div class="producto">
        <img src="imagenes/camisa.jpg" alt="Camisa personalizada" width="200" />
        <p>Camisa personalizada</p>
      </div>
      <div class="producto">
        <img src="imagenes/arma.jpg" alt="Arma personalizada" width="200" />
        <p>Arma personalizada</p>
      </div>
    </div>
  `;
});

// âœ… 8. Volver al inicio
function mostrarInicio() {
  contenidoPrincipal.innerHTML = `
    <h2>Bienvenido</h2>
    <p>Contenido principal inicial aquÃ­...</p>
  `;
}

// âœ… 9. Alternar secciones (Â¿QuiÃ©nes Somos? / Testimonios)
function toggleSection(sectionId, buttonId) {
  const section = document.getElementById(sectionId);
  const button = document.getElementById(buttonId);
  const showing = !section.classList.contains('hidden');
  section.classList.toggle('hidden');
  button.textContent = showing
    ? (sectionId === 'quienes' ? 'Mostrar Â¿QuiÃ©nes Somos?' : 'Mostrar Testimonios')
    : (sectionId === 'quienes' ? 'Ocultar Â¿QuiÃ©nes Somos?' : 'Ocultar Testimonios');
}
